@prefix cwl: <https://w3id.org/cwl/cwl#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix geo: <http://www.opengis.net/ont/geosparql#> .
@prefix ns1: <rdf:> .
@prefix ogcproc: <http://www.opengis.net/def/ogcapi/processes/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

[] cwl:cwlVersion <file:///github/workspace/v1.2> ;
    cwl:graph [ rdfs:label "Echo OGC BBox"^^xsd:string ;
            dct:identifier <file:///github/workspace/clt> ;
            ogcproc:input _:N9b570d691a92443ca5810809d1ea1d23 ;
            ogcproc:output _:N7e5e3440145a44419f37bb2c650daf5d ;
            cwl:baseCommand "\"echo\""^^rdf:JSON ;
            cwl:input _:N9b570d691a92443ca5810809d1ea1d23 ;
            cwl:output _:N7e5e3440145a44419f37bb2c650daf5d ;
            cwl:requirements [ cwl:types [ cwl:import <https://raw.githubusercontent.com/eoap/schemas/main/ogc.yaml> ] ;
                    ns1:type <file:///github/workspace/SchemaDefRequirement> ],
                [ ns1:type <file:///github/workspace/InlineJavascriptRequirement> ] ;
            cwl:stdout "echo_output.txt"^^xsd:string ;
            ns1:type <file:///github/workspace/CommandLineTool> ],
        [ rdfs:label "OGC BBox Processing Workflow"^^xsd:string ;
            dct:identifier <file:///github/workspace/bbox-workflow> ;
            ogcproc:input _:N2aa0e2b2048d40efadd4056fe2da99ff ;
            ogcproc:output _:Nb7d959c183c64ad589323871e9c2573a ;
            rdfs:comment "Workflow that processes OGC BBox input and generates output"^^xsd:string ;
            cwl:input _:N2aa0e2b2048d40efadd4056fe2da99ff ;
            cwl:output _:Nb7d959c183c64ad589323871e9c2573a ;
            cwl:requirements [ ns1:type <file:///github/workspace/InlineJavascriptRequirement> ],
                [ cwl:types [ cwl:import <https://raw.githubusercontent.com/eoap/schemas/main/ogc.yaml> ] ;
                    ns1:type <file:///github/workspace/SchemaDefRequirement> ] ;
            cwl:steps [ cwl:echo_step [ cwl:in [ cwl:aoi "aoi" ] ;
                            cwl:out ( "echo_output" ) ;
                            cwl:run <file:///github/workspace/#clt> ] ] ;
            ns1:type <file:///github/workspace/Workflow> ] .

_:N0123d86b40ba4ca693dd762dc38e8bbb rdfs:label "Echo output"^^xsd:string ;
    dct:identifier <file:///github/workspace/echo_output> ;
    rdfs:comment "Echoed BBox information"^^xsd:string ;
    cwl:outputSource <file:///github/workspace/echo_step/echo_output> ;
    cwl:type <file:///github/workspace/File> .

_:N63da9710aec54c399896bb16368533a7 rdfs:label "Area of interest"^^xsd:string ;
    ogcproc:itemsType "number"^^xsd:string ;
    ogcproc:maxItems 6 ;
    ogcproc:minItems 4 ;
    ogcproc:schemaType "array"^^xsd:string ;
    rdfs:comment "Area of interest defined as a bounding box"^^xsd:string ;
    rdfs:seeAlso geo:BoundingBox ;
    cwl:inputBinding [ cwl:valueFrom """${
  // Validate the length of bbox to be either 4 or 6
  var bboxLength = inputs.aoi.bbox.length;
  if (bboxLength !== 4 && bboxLength !== 6) {
    throw "Invalid bbox length: bbox must have either 4 or 6 elements.";
  }
  // Convert bbox array to a space-separated string for echo
  return inputs.aoi.bbox.join(' ') + " CRS: " + inputs.aoi.crs;
}
"""^^xsd:string ] ;
    cwl:type <https://raw.githubusercontent.com/eoap/schemas/main/ogc.yaml#BBox> .

_:N6456c3df4272487db91edcd2db86f725 rdfs:label "Area of interest"^^xsd:string ;
    dct:identifier <file:///github/workspace/aoi> ;
    ogcproc:itemsType "number"^^xsd:string ;
    ogcproc:maxItems 6 ;
    ogcproc:minItems 4 ;
    ogcproc:schemaType "array"^^xsd:string ;
    rdfs:comment "Area of interest defined as a bounding box"^^xsd:string ;
    rdfs:seeAlso geo:BoundingBox ;
    cwl:type <https://raw.githubusercontent.com/eoap/schemas/main/ogc.yaml#BBox> .

_:Na9e5bd2930c54eb2a4f7726083accf83 cwl:aoi _:N63da9710aec54c399896bb16368533a7 .

_:Nc3899f595b3b46b2a175179c94076d04 cwl:echo_output [ cwl:type <file:///github/workspace/stdout> ] .

_:N2aa0e2b2048d40efadd4056fe2da99ff a ogcproc:InputDescription ;
    rdf:first _:N6456c3df4272487db91edcd2db86f725 ;
    rdf:rest () .

_:N7e5e3440145a44419f37bb2c650daf5d a ogcproc:OutputDescription ;
    rdf:first _:Nc3899f595b3b46b2a175179c94076d04 ;
    rdf:rest () .

_:N9b570d691a92443ca5810809d1ea1d23 a ogcproc:InputDescription ;
    rdf:first _:Na9e5bd2930c54eb2a4f7726083accf83 ;
    rdf:rest () .

_:Nb7d959c183c64ad589323871e9c2573a a ogcproc:OutputDescription ;
    rdf:first _:N0123d86b40ba4ca693dd762dc38e8bbb ;
    rdf:rest () .

